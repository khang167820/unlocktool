# .htaccess cho unlocktool.us
# Đảm bảo routing đúng và bảo mật

# Bật RewriteEngine
RewriteEngine On

# Chuyển hướng www sang non-www hoặc ngược lại (tùy chọn)
# RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
# RewriteRule ^(.*)$ https://%1/$1 [R=301,L]

# Chuyển hướng HTTP sang HTTPS
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Bảo vệ file config
<FilesMatch "^(config\.php|\.htaccess|\.htpasswd)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Bảo vệ thư mục admin (nếu chưa có .htaccess riêng)
# <DirectoryMatch "^.*/admin/.*">
#     Options -Indexes
# </DirectoryMatch>

# Xử lý lỗi 404
ErrorDocument 404 /index.php

# Tắt directory listing
Options -Indexes

# Bảo vệ file nhạy cảm
<FilesMatch "\.(log|sql|bak|backup|old)$">
    Order allow,deny
    Deny from all
</FilesMatch>

# Thiết lập charset mặc định
AddDefaultCharset UTF-8

# Bảo vệ chống hotlinking (tùy chọn)
# RewriteCond %{HTTP_REFERER} !^$
# RewriteCond %{HTTP_REFERER} !^https?://(www\.)?unlocktool\.us [NC]
# RewriteRule \.(jpg|jpeg|png|gif|css|js)$ - [F,L]















# DO NOT REMOVE THIS LINE AND THE LINES BELOW IPDENYID:4tyWu4JYxM
deny from 2a09:bac1:7ac0:10::3c3:36
# DO NOT REMOVE THIS LINE AND THE LINES ABOVE 4tyWu4JYxM:IPDENYID


# DO NOT REMOVE THIS LINE AND THE LINES BELOW IPDENYID:BYq32qYYO0
deny from 2405:4802:8100:3120:ce60:89a2:a8b5:c1ac
# DO NOT REMOVE THIS LINE AND THE LINES ABOVE BYq32qYYO0:IPDENYID


# DO NOT REMOVE THIS LINE AND THE LINES BELOW IPDENYID:hsaPYCdJ9P
deny from 2a09:bac1:7ac0:10::3c3:31
# DO NOT REMOVE THIS LINE AND THE LINES ABOVE hsaPYCdJ9P:IPDENYID


# DO NOT REMOVE THIS LINE AND THE LINES BELOW IPDENYID:IHx2U7dtqF
deny from 103.176.152.28
# DO NOT REMOVE THIS LINE AND THE LINES ABOVE IHx2U7dtqF:IPDENYID


# DO NOT REMOVE THIS LINE AND THE LINES BELOW IPDENYID:agM8pCkUwH
deny from 42.115.217.99
# DO NOT REMOVE THIS LINE AND THE LINES ABOVE agM8pCkUwH:IPDENYID


# DO NOT REMOVE THIS LINE AND THE LINES BELOW IPDENYID:DBEIDyZpsW
deny from 151.241.19.24
# DO NOT REMOVE THIS LINE AND THE LINES ABOVE DBEIDyZpsW:IPDENYID


# DO NOT REMOVE THIS LINE AND THE LINES BELOW IPDENYID:pKL1BMzvSd
deny from 103.176.152.40
# DO NOT REMOVE THIS LINE AND THE LINES ABOVE pKL1BMzvSd:IPDENYID

